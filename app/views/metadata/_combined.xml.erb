<%
timestamp = Time.now.utc
xsd_datetime_format = "%FT%T%:z"
id_prefix = "QE_#{object.id.to_s[0...7]}"
%>
<!-- Fragment automatically generated by the GeoViQua Quality Emitter at <%= timestamp.strftime(xsd_datetime_format) %> -->
<gvq:dataQualityInfo>
    <gmd19157:DQ_DataQuality>
        <!-- ==============================================
             Scope
             ============================================== -->
        <gmd19157:scope>
            <gmd19157:DQ_Scope id="<%= id_prefix %>_DatasetScope">
                <gmd19157:level>
                    <gmd:MD_ScopeCode codeList="http://www.isotc211.org/2005/resources/Codelist/gmxCodelists.xml#MD_ScopeCode" codeListValue="dataset">dataset</gmd:MD_ScopeCode>
                </gmd19157:level>
            </gmd19157:DQ_Scope>
        </gmd19157:scope>
        <!-- ==============================================
             Metaquality
             ============================================== -->
        <gmd19157:report>
            <gmd19157:DQ_Confidence id="<%= id_prefix %>_Metaquality">
                <gmd19157:measure>
                    <gmd19157:DQ_MeasureReference>
                        <gmd19157:measureDescription>
                            <gco:CharacterString>Series of metaquality summaries computed assuming a normal distribution of the errors.</gco:CharacterString>
                        </gmd19157:measureDescription>
                    </gmd19157:DQ_MeasureReference>
                </gmd19157:measure>
                <!-- Main evaluation report to reference the Quality Emitter -->
                <gmd19157:evaluation>
                    <gvq:GVQ_SampleBasedInspection id="<%= id_prefix %>_Evaluation">
                        <gmd19157:evaluationMethodDescription>
                            <gco:CharacterString>General validation approach based on computing statistics of the differences between the reference data and the observed values.</gco:CharacterString>
                        </gmd19157:evaluationMethodDescription>
                        <gmd19157:evaluationProcedure xlink:href="#<%= id_prefix %>_ToolCitation" />
                        <!-- TODO: Reference the 3.3 deliverable -->
                        <gmd19157:referenceDoc gco:nilReason="missing" />
                        <gmd19157:evaluationMethodType>
                            <gmd19157:DQ_EvaluationMethodTypeCode codeList="http://schemas.geoviqua.org/ISO/19157/20120707_GVQ/resources/Codelist/gmd19157_Codelists.xml" codeListValue="directExternal">directExternal</gmd19157:DQ_EvaluationMethodTypeCode>
                        </gmd19157:evaluationMethodType>
                        <gmd19157:samplingScheme>
                            <gco:CharacterString>Random sampling based on available collocations into two lots.</gco:CharacterString>
                        </gmd19157:samplingScheme>
                        <gmd19157:lotDescription>
                            <gco:CharacterString><%= "#{object.learning_percentage}%" %> used for learning quality indicators, <%= "#{100 - object.learning_percentage}%" %> used for computing metaquality indicators.</gco:CharacterString>
                        </gmd19157:lotDescription>
                        <gmd19157:samplingRatio gco:nilReason="inapplicable" />
                        <gvq:referenceDataset>
                            <updated19115:MD_AssociatedResource>
                                <updated19115:name>
                                    <!-- TODO: Reference the datasets that form the reference data for GECA -->
                                    <gmd:CI_Citation>
                                        <gmd:title gco:nilReason="missing" />
                                        <gmd:date gco:nilReason="missing" />
                                    </gmd:CI_Citation>
                                </updated19115:name>
                                <updated19115:associationType>
                                    <gmd:DS_AssociationTypeCode codeList="http://www.isotc211.org/2005/resources/Codelist/gmxCodelists.xml" codeListValue="crossReference">crossReference</gmd:DS_AssociationTypeCode>
                                </updated19115:associationType>
                            </updated19115:MD_AssociatedResource>
                        </gvq:referenceDataset>
                    </gvq:GVQ_SampleBasedInspection>
                </gmd19157:evaluation>
                <gmd19157:result>
                    <gmd19157:DQ_QuantitativeResult>
                        <gmd19157:resultScope xlink:href="#<%= id_prefix %>_DatasetScope" />
                        <gmd19157:valueType gco:nilReason="inapplicable" />
                        <gmd19157:valueUnit gco:nilReason="inapplicable" />
                        <gmd19157:value>
                            <gco:Record>
                                <gmd:URL><%= validation_url(object) %></gmd:URL>
                            </gco:Record>
                        </gmd19157:value>
                    </gmd19157:DQ_QuantitativeResult>
                </gmd19157:result>
                <gmd19157:derivedElement gco:nilReason="inapplicable" />
                <gmd19157:relatedElement gco:nilReason="inapplicable" />
            </gmd19157:DQ_Confidence>
        </gmd19157:report>
        <!-- ==============================================
             Lineage
             ============================================== -->
        <gmd19157:lineage>
            <gmd19157:LI_Lineage id="<%= id_prefix %>_ToolReference">
                <gmd19157:processStep>
                    <gmd19157:LI_ProcessStep>
                        <gmd19157:description>
                            <gco:CharacterString>
                                The following quality reports were automatically generated by the GeoViQua Quality Emitter, a tool that computes and validates quality indicators for continuously-valued data.
                            </gco:CharacterString>
                        </gmd19157:description>
                        <gmd19157:source>
                            <gmd19157:LI_Source id="<%= id_prefix %>_ToolSource">
                                <gmd19157:description>
                                    <gco:CharacterString>
                                        A service that computes a range of quantitative quality indicators at the dataset level, assuming that error characteristics are homogeneous.
                                    </gco:CharacterString>
                                </gmd19157:description>
                                <gmd19157:sourceCitation>
                                    <gmd:CI_Citation id="<%= id_prefix %>_ToolCitation">
                                        <gmd:title>
                                            <gco:CharacterString>Quality Emitter</gco:CharacterString>
                                        </gmd:title>
                                        <gmd:date gco:nilReason="inapplicable" />
                                        <gmd:citedResponsibleParty>
                                            <gmd:CI_ResponsibleParty>
                                                <gmd:organisationName>
                                                    <gco:CharacterString>GeoViQua</gco:CharacterString>
                                                </gmd:organisationName>
                                                <gmd:contactInfo>
                                                    <gmd:CI_Contact>
                                                        <gmd:address>
                                                            <gmd:CI_Address>
                                                                <gmd:electronicMailAddress>
                                                                    <gco:CharacterString>geoviqua@creaf.uab.cat</gco:CharacterString>
                                                                </gmd:electronicMailAddress>
                                                            </gmd:CI_Address>
                                                        </gmd:address>
                                                        <gmd:onlineResource>
                                                            <updated19115:CI_OnlineResource>
                                                                <gmd:linkage>
                                                                    <gmd:URL><%= root_url %></gmd:URL>
                                                                </gmd:linkage>
                                                            </updated19115:CI_OnlineResource>
                                                        </gmd:onlineResource>
                                                    </gmd:CI_Contact>
                                                </gmd:contactInfo>
                                                <gmd:role>
                                                    <gmd:CI_RoleCode codeList="http://www.isotc211.org/2005/resources/Codelist/gmxCodelists.xml#CI_RoleCode" codeListValue="author">author</gmd:CI_RoleCode>
                                                </gmd:role>
                                            </gmd:CI_ResponsibleParty>
                                        </gmd:citedResponsibleParty>
                                    </gmd:CI_Citation>
                                </gmd19157:sourceCitation>
                            </gmd19157:LI_Source>
                        </gmd19157:source>
                    </gmd19157:LI_ProcessStep>
                </gmd19157:processStep>
            </gmd19157:LI_Lineage>
        </gmd19157:lineage>
    </gmd19157:DQ_DataQuality>
</gvq:dataQualityInfo>
<!-- End of GeoViQua Quality Emitter fragment -->